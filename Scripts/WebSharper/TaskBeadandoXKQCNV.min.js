(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;a=self;b=a.TaskBeadandoXKQCNV=a.TaskBeadandoXKQCNV||{};c=b.Path=b.Path||{};d=c.CanvasNode=c.CanvasNode||{};e=b.Client=b.Client||{};f=a.StartupCode$TaskBeadandoXKQCNV$Client=a.StartupCode$TaskBeadandoXKQCNV$Client||{};g=a.WebSharper;h=g&&g.UI;i=h&&h.Doc;j=h&&h.AttrProxy;k=g&&g.Arrays;l=g&&g.Strings;m=g&&g.Arrays2D;n=g&&g.Operators;o=g&&g.Enumerator;p=a.console;q=g&&g.Html;r=q&&q.Client;s=r&&r.Operators;t=r&&r.Attr;u=r&&r.Tags;v=r&&r.EventsPervasives;w=h&&h.Var$1;x=a.IntelliFactory;y=x&&x.Runtime;d.New=function(z,A,B,C){return{Red:z,Green:A,Blue:B,Alpha:C};};e.Main=function(){return i.Element("div",[j.Create("style","\n        text-align: center; ")],[i.Button("Pick Start",[j.Create("style","background: #a8ffa8;color:black;")],function(){a.alert("");}),i.Button("Pick End",[j.Create("style","background: #aba8ff;color:black;")],function(){a.alert("");}),i.Element("table",[],[i.Element("tr",[],[i.Element("td",[],[i.Element("h3",[],[i.TextNode("Brush size:")]),i.Input([j.Create("style","width:75px"),j.Create("type","range"),j.Create("min","3"),j.Create("max","40"),j.Create("class","slider")],e.brushSize())]),i.Element("td",[],[i.Element("h2",[],[i.TextNode("Toggle brush types:")]),i.Button("",[j.Create("style","color:#a434b3;"),j.Create("class","fa fa-eraser")],function(){e.set_brushMode(1);}),i.Button("",[j.Create("style","color:#b35034;"),j.Create("class","fa fa-edit")],function(){e.set_brushMode(0);})])])]),i.Element("br",[],[]),i.Button("Create path!",[],function(){var z,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q;function A(){z=z+1;}function B(R,S){return a.String(R)+" "+a.String(S)+" "+("Red: "+a.String(k.get2D(E,R,S).Red)+" ")+("Green: "+a.String(k.get2D(E,R,S).Green)+" ")+("Blue: "+a.String(k.get2D(E,R,S).Blue)+" ")+("Alpha: "+a.String(k.get2D(E,R,S).Alpha)+" ")+"\n";}C=e.ctx().getImageData(0,0,e.canvas().width,e.canvas().height).data;D=l.SplitChars(a.String(C),[","],0);E=m.init(e.canvas().width,e.canvas().height,function(){return d.New(0,0,0,0);});z=0;F=n.step(0,1,e.canvas().width-1);G=o.Get(F);try{while(G.MoveNext()){H=G.Current();I=n.step(0,1,e.canvas().height-1);J=o.Get(I);try{while(J.MoveNext()){K=J.Current();k.get2D(E,H,K).Red=n.toInt(a.Number(k.get(D,z)));A();k.get2D(E,H,K).Green=n.toInt(a.Number(k.get(D,z)));A();k.get2D(E,H,K).Blue=n.toInt(a.Number(k.get(D,z)));A();k.get2D(E,H,K).Alpha=n.toInt(a.Number(k.get(D,z)));A();}}finally{if(typeof J=="object"&&"Dispose"in J)J.Dispose();}}}finally{if(typeof G=="object"&&"Dispose"in G)G.Dispose();}a.alert(B(0,0)+B(2,2)+B(5,5));p.log(a.String(C));p.log(E);e.canvas().height=e.canvas().height;e.canvas().width=e.canvas().width;L=n.step(0,1,e.canvas().width-1);M=o.Get(L);try{while(M.MoveNext()){N=M.Current();O=n.step(0,1,e.canvas().height-1);P=o.Get(O);try{while(P.MoveNext()){Q=P.Current();k.get2D(E,N,Q).Alpha>0?(e.ctx().fillStyle="#000000",e.ctx().fillRect(Q,N,1,1)):void 0;}}finally{if(typeof P=="object"&&"Dispose"in P)P.Dispose();}}}finally{if(typeof M=="object"&&"Dispose"in M)M.Dispose();}}),i.Element("div",[],[i.Element("h1",[],[i.TextNode("Edit map")]),i.Element("table",[],[i.Element("tr",[],[i.Element("td",[],[i.Element("h3",[],[i.TextNode("Map Size:")]),i.Input([j.Create("style","width:100px"),j.Create("type","range"),j.Create("min","100"),j.Create("max","800"),j.Create("class","slider")],e.MapSize())]),i.Element("td",[],[i.Button("Reset/Clear",[j.Create("style","background: red;color:white;")],function(){e.canvas().height=n.toInt(a.Number(e.MapSize().Get()));e.canvas().width=n.toInt(a.Number(e.MapSize().Get()));e.ctx().lineCap="round";})])])])])]);};e.Canvas=function(){var z,A,B,C,D,E,F,G;function H(M,N){var O,P,Q;O=e.getXYFromMouseEvent(M,N);P=O[1];Q=O[0];e.updatePos(Q,P);(e.lastX())[0]=Q;(e.lastY())[0]=P;(e.inLine())[0]=true;e.ctx().beginPath();e.ctx().strokeStyle="#000000";e.ctx().fillStyle="#000000";return e.drawFixedPoints();}function I(M,N){var O;(e.inLine())[0]=false;O=e.getXYFromMouseEvent(M,N);return e.updatePos(O[0],O[1]);}function J(M,N){var O,P,Q;O=e.getXYFromMouseEvent(M,N);P=O[1];Q=O[0];e.updatePos(Q,P);return(e.inLine())[0]?(e.ctx().moveTo((e.lastX())[0],(e.lastY())[0]),e.ctx().lineTo(Q,P),e.ctx().lineWidth=a.Number(e.brushSize().Get()),e.brushMode()===0?e.ctx().stroke():void 0,e.brushMode()===1?(e.ctx().strokeStyle="rgba(0,0,0,0)",e.ctx().clearRect(Q-a.Number(e.brushSize().Get())/2,P-a.Number(e.brushSize().Get())/2,a.Number(e.brushSize().Get()),a.Number(e.brushSize().Get())),e.ctx().stroke()):void 0,(e.lastX())[0]=Q,(e.lastY())[0]=P,e.drawFixedPoints()):null;}function K(M,N){var O;O=e.getXYFromMouseEvent(M,N);return e.updatePos(O[0],O[1]);}function L(M,N){(e.inLine())[0]=false;}e.drawFixedPoints();e.ctx().scale(1,1);return s.add((z=[t.Attr().NewAttr("style","\n        text-align: center; \n        -ms-interpolation-mode: nearest-neighbor;\n        image-rendering: pixelated;\n        cursor: crosshair")],u.Tags().NewTag("div",z)),[e.labelPos(),u.Tags().NewTag("br",[]),(A=(B=(C=(D=(E=s.add(e.element(),[t.Attr().NewAttr("style","border: 1px solid gray")]),(function(M){v.Events().OnMouseDown(function(N){return function(O){return H(N,O);};},M);}(E),E)),(function(M){v.Events().OnMouseUp(function(N){return function(O){return I(N,O);};},M);}(D),D)),(function(M){v.Events().OnMouseMove(function(N){return function(O){return J(N,O);};},M);}(C),C)),(function(M){v.Events().OnMouseEnter(function(N){return function(O){return K(N,O);};},M);}(B),B)),(function(M){v.Events().OnMouseLeave(function(N){return function(O){return L(N,O);};},M);}(A),A)),(F=[(G=[u.Tags().text("Draw with your mouse")],u.Tags().NewTag("b",G))],u.Tags().NewTag("p",F))]);};e.drawFixedPoints=function(){e.drawStart();e.drawEnd();};e.drawEnd=function(){e.ctx().fillStyle="#0000ff";e.ctx().fillRect(e.endX(),e.endY(),10,10);};e.drawStart=function(){e.ctx().fillStyle="#ff0000";e.ctx().fillRect(e.startX(),e.startY(),10,10);};e.ctx=function(){f.$cctor();return f.ctx;};e.canvas=function(){f.$cctor();return f.canvas;};e.getXYFromMouseEvent=function(z,A){var B;B=a.jQuery(z.get_Body()).position();return[A.X-n.toInt(B.left),A.Y-n.toInt(B.top)];};e.updatePos=function(z,A){var B,C;B=e.labelPos();B.HtmlProvider.Clear(B.get_Body());C=e.labelPos();C.HtmlProvider.AppendNode(C.get_Body(),C.HtmlProvider.CreateTextNode("X="+a.String(z)+", Y="+a.String(A)));};e.labelPos=function(){f.$cctor();return f.labelPos;};e.inLine=function(){f.$cctor();return f.inLine;};e.lastX=function(){f.$cctor();return f.lastX;};e.lastY=function(){f.$cctor();return f.lastY;};e.element=function(){f.$cctor();return f.element;};e.MapSize=function(){f.$cctor();return f.MapSize;};e.brushMode=function(){f.$cctor();return f.brushMode;};e.set_brushMode=function(z){f.$cctor();f.brushMode=z;};e.brushSize=function(){f.$cctor();return f.brushSize;};e.endY=function(){f.$cctor();return f.endY;};e.endX=function(){f.$cctor();return f.endX;};e.startY=function(){f.$cctor();return f.startY;};e.startX=function(){f.$cctor();return f.startX;};e.rvInput=function(){f.$cctor();return f.rvInput;};f.$cctor=function(){var z,A;f.$cctor=a.ignore;f.rvInput=w.Create$1("");f.startX=2;f.startY=2;f.endX=250;f.endY=250;f.brushSize=w.Create$1(a.String(5));f.brushMode=0;f.MapSize=w.Create$1(a.String(500));f.element=u.Tags().NewTag("canvas",[]);z=[[0],[0],[false]];f.lastY=z[1];f.lastX=z[0];f.inLine=z[2];f.labelPos=(A=[u.Tags().text("Position:")],u.Tags().NewTag("span",A));f.canvas=e.element().Dom;e.canvas().height=n.toInt(a.Number(e.MapSize().Get()));e.canvas().width=n.toInt(a.Number(e.MapSize().Get()));f.ctx=e.canvas().getContext("2d");e.ctx().lineCap="round";};y.OnLoad(function(){e.Canvas();});}());
