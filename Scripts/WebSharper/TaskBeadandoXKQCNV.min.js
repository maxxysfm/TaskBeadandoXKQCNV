(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;a=self;b=a.TaskBeadandoXKQCNV=a.TaskBeadandoXKQCNV||{};c=b.Path=b.Path||{};d=c.CanvasNode=c.CanvasNode||{};e=b.Client=b.Client||{};f=a.StartupCode$TaskBeadandoXKQCNV$Client=a.StartupCode$TaskBeadandoXKQCNV$Client||{};g=a.WebSharper;h=g&&g.UI;i=h&&h.Doc;j=h&&h.AttrProxy;k=g&&g.Strings;l=g&&g.Arrays2D;m=g&&g.Operators;n=g&&g.Enumerator;o=g&&g.Arrays;p=a.console;q=g&&g.Html;r=q&&q.Client;s=r&&r.Operators;t=r&&r.Attr;u=r&&r.Tags;v=r&&r.EventsPervasives;w=h&&h.Var$1;x=a.IntelliFactory;y=x&&x.Runtime;d.New=function(z,A,B,C){return{Red:z,Green:A,Blue:B,Alpha:C};};e.Main=function(){return i.Element("div",[j.Create("style","text-align: center; ")],[i.Button("Pick Start",[j.Create("style","background: #a8ffa8;color:black;")],function(){e.set_brushMode(2);}),i.Button("Pick End",[j.Create("style","background: #aba8ff;color:black;")],function(){e.set_brushMode(3);}),i.Element("table",[],[i.Element("th",[],[i.Element("tr",[],[i.Element("h3",[],[i.TextNode("Brush size:")]),i.Input([j.Create("style","width:75px"),j.Create("type","range"),j.Create("min","3"),j.Create("max","40"),j.Create("class","slider")],e.brushSize())]),i.Element("tr",[],[i.Element("h2",[],[i.TextNode("Toggle brush types:")]),i.Button("",[j.Create("style","color:#a434b3;"),j.Create("class","fa fa-eraser")],function(){e.set_brushMode(1);}),i.Button("",[j.Create("style","color:#b35034;"),j.Create("class","fa fa-edit")],function(){e.set_brushMode(0);})]),i.Element("tr",[],[i.Button("Create path!",[],function(){var z,A,C,D,E,F,G,H,I,J,K;function B(){A=A+1;}C=e.ctx().getImageData(0,0,e.canvas().width,e.canvas().height).data;e.set_CachedCanvas(e.ctx().getImageData(0,0,e.canvas().width,e.canvas().height));D=k.SplitChars(a.String(C),[","],0);E=l.init(e.canvas().width,e.canvas().height,function(){return d.New(0,0,0,0);});A=0;F=m.step(0,1,e.canvas().width-1);G=n.Get(F);try{while(G.MoveNext()){H=G.Current();I=m.step(0,1,e.canvas().height-1);J=n.Get(I);try{while(J.MoveNext()){K=J.Current();o.get2D(E,H,K).Red=m.toInt(a.Number(o.get(D,A)));B();o.get2D(E,H,K).Green=m.toInt(a.Number(o.get(D,A)));B();o.get2D(E,H,K).Blue=m.toInt(a.Number(o.get(D,A)));B();o.get2D(E,H,K).Alpha=m.toInt(a.Number(o.get(D,A)));B();}}finally{if(typeof J=="object"&&"Dispose"in J)J.Dispose();}}}finally{if(typeof G=="object"&&"Dispose"in G)G.Dispose();}p.log(a.String(C));p.log(E);p.log(e.autoPathfind().Get());})]),i.Element("tr",[],[i.Element("h3",[j.Create("style","text-align: center;")],[i.TextNode("Auto pathfind:")]),i.CheckBox([j.Create("style","text-align: center;\n                    vertical-align: middle;\n                    margin-left: 50px;")],e.autoPathfind())])])]),i.Element("br",[],[]),i.Button("Debug",[],function(){e.ctx().putImageData(e.CachedCanvas(),0,0);}),i.Element("div",[],[i.Element("h1",[],[i.TextNode("Edit map")]),i.Element("table",[],[i.Element("tr",[],[i.Element("td",[],[i.Element("h3",[],[i.TextNode("Map Size:")]),i.Input([j.Create("style","width:100px"),j.Create("type","range"),j.Create("min","100"),j.Create("max","800"),j.Create("class","slider")],e.MapSize())]),i.Element("td",[],[i.Button("Reset/Clear",[j.Create("style","background: red;color:white;")],function(){e.canvas().height=m.toInt(a.Number(e.MapSize().Get()));e.canvas().width=m.toInt(a.Number(e.MapSize().Get()));e.ctx().lineCap="round";e.draw();})])])])])]);};e.Canvas=function(){var z,A,B,C,D,E,F,G;function H(M,N){var O,P,Q;O=e.getXYFromMouseEvent(M,N);P=O[1];Q=O[0];e.updatePos(Q,P);(e.lastX())[0]=Q;(e.lastY())[0]=P;(e.inLine())[0]=true;e.ctx().beginPath();e.ctx().strokeStyle="#000000";e.ctx().fillStyle="#000000";return e.draw();}function I(M,N){var O;(e.inLine())[0]=false;O=e.getXYFromMouseEvent(M,N);return e.updatePos(O[0],O[1]);}function J(M,N){var O,P,Q,R,S;O=e.getXYFromMouseEvent(M,N);P=O[1];Q=O[0];e.updatePos(Q,P);return(e.inLine())[0]?(e.ctx().moveTo((e.lastX())[0],(e.lastY())[0]),e.ctx().lineTo(Q,P),e.ctx().lineWidth=a.Number(e.brushSize().Get()),e.brushMode()===0?e.ctx().stroke():void 0,e.brushMode()===1?(R=20,S=a.Number(e.brushSize().Get())+R,e.ctx().clearRect(Q+R-S,P+R-S,S,S)):void 0,e.brushMode()===2?(e.clearStart(),e.set_startX(Q),e.set_startY(P)):void 0,e.brushMode()===3?(e.clearEnd(),e.set_endX(Q),e.set_endY(P)):void 0,(e.lastX())[0]=Q,(e.lastY())[0]=P,e.draw()):null;}function K(M,N){var O;O=e.getXYFromMouseEvent(M,N);return e.updatePos(O[0],O[1]);}function L(M,N){(e.inLine())[0]=false;}e.draw();e.ctx().scale(1,1);return s.add((z=[t.Attr().NewAttr("style","\n        text-align: center; \n        -ms-interpolation-mode: nearest-neighbor;\n        image-rendering: pixelated;\n        cursor: crosshair")],u.Tags().NewTag("div",z)),[e.labelPos(),u.Tags().NewTag("br",[]),(A=(B=(C=(D=(E=s.add(e.element(),[t.Attr().NewAttr("style","border: 1px solid gray")]),(function(M){v.Events().OnMouseDown(function(N){return function(O){return H(N,O);};},M);}(E),E)),(function(M){v.Events().OnMouseUp(function(N){return function(O){return I(N,O);};},M);}(D),D)),(function(M){v.Events().OnMouseMove(function(N){return function(O){return J(N,O);};},M);}(C),C)),(function(M){v.Events().OnMouseEnter(function(N){return function(O){return K(N,O);};},M);}(B),B)),(function(M){v.Events().OnMouseLeave(function(N){return function(O){return L(N,O);};},M);}(A),A)),(F=[(G=[u.Tags().text("Draw with your mouse")],u.Tags().NewTag("b",G))],u.Tags().NewTag("p",F))]);};e.draw=function(){e.drawStart();e.drawEnd();};e.clearEnd=function(){e.ctx().clearRect(e.endX(),e.endY(),e.BorderSize(),e.BorderSize());};e.drawEnd=function(){e.ctx().fillStyle="#0000ff";e.ctx().fillRect(e.endX(),e.endY(),e.BorderSize(),e.BorderSize());};e.clearStart=function(){e.ctx().clearRect(e.startX(),e.startY(),e.BorderSize(),e.BorderSize());};e.drawStart=function(){e.ctx().fillStyle="#00ff00";e.ctx().fillRect(e.startX(),e.startY(),e.BorderSize(),e.BorderSize());};e.ctx=function(){f.$cctor();return f.ctx;};e.canvas=function(){f.$cctor();return f.canvas;};e.getXYFromMouseEvent=function(z,A){var B;B=a.jQuery(z.get_Body()).position();return[A.X-m.toInt(B.left),A.Y-m.toInt(B.top)];};e.updatePos=function(z,A){var B,C;B=e.labelPos();B.HtmlProvider.Clear(B.get_Body());C=e.labelPos();C.HtmlProvider.AppendNode(C.get_Body(),C.HtmlProvider.CreateTextNode("X="+a.String(z)+", Y="+a.String(A)));};e.labelPos=function(){f.$cctor();return f.labelPos;};e.inLine=function(){f.$cctor();return f.inLine;};e.lastX=function(){f.$cctor();return f.lastX;};e.lastY=function(){f.$cctor();return f.lastY;};e.element=function(){f.$cctor();return f.element;};e.MapSize=function(){f.$cctor();return f.MapSize;};e.CachedCanvas=function(){f.$cctor();return f.CachedCanvas;};e.set_CachedCanvas=function(z){f.$cctor();f.CachedCanvas=z;};e.autoPathfind=function(){f.$cctor();return f.autoPathfind;};e.brushMode=function(){f.$cctor();return f.brushMode;};e.set_brushMode=function(z){f.$cctor();f.brushMode=z;};e.brushSize=function(){f.$cctor();return f.brushSize;};e.endY=function(){f.$cctor();return f.endY;};e.set_endY=function(z){f.$cctor();f.endY=z;};e.endX=function(){f.$cctor();return f.endX;};e.set_endX=function(z){f.$cctor();f.endX=z;};e.startY=function(){f.$cctor();return f.startY;};e.set_startY=function(z){f.$cctor();f.startY=z;};e.startX=function(){f.$cctor();return f.startX;};e.set_startX=function(z){f.$cctor();f.startX=z;};e.BorderSize=function(){f.$cctor();return f.BorderSize;};e.initialOffset=function(){f.$cctor();return f.initialOffset;};e.initialSize=function(){f.$cctor();return f.initialSize;};f.$cctor=function(){var z,A;f.$cctor=a.ignore;f.initialSize=500;f.initialOffset=25;f.BorderSize=12;f.startX=e.initialOffset();f.startY=e.initialOffset();f.endX=e.initialSize()-e.initialOffset();f.endY=e.initialSize()-e.initialOffset();f.brushSize=w.Create$1(a.String(15));f.brushMode=0;f.autoPathfind=w.Create$1(false);f.CachedCanvas=null;f.MapSize=w.Create$1(a.String(e.initialSize()));f.element=u.Tags().NewTag("canvas",[]);z=[[0],[0],[false]];f.lastY=z[1];f.lastX=z[0];f.inLine=z[2];f.labelPos=(A=[u.Tags().text("Position:")],u.Tags().NewTag("span",A));f.canvas=e.element().Dom;e.canvas().height=m.toInt(a.Number(e.MapSize().Get()));e.canvas().width=m.toInt(a.Number(e.MapSize().Get()));f.ctx=e.canvas().getContext("2d");e.ctx().lineCap="round";};y.OnLoad(function(){e.Canvas();});}());
